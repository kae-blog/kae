---
// src/components/PostCardHorizontal.astro (å·²ä¿®æ­£ï¼šé›»è…¦ç‰ˆå–®è¡Œæˆªæ–· + æ‰‹æ©Ÿç‰ˆåž‚ç›´å †ç–Š)
import type { CollectionEntry } from 'astro:content';

interface Props {
  post: CollectionEntry<'blog'>;
}

const { post } = Astro.props;

const formatDate = (date: Date) => {
  const d = new Date(date);
  return `${d.getFullYear()}/${String(d.getMonth() + 1).padStart(2, '0')}/${String(d.getDate()).padStart(2, '0')}`;
};

const MOBILE_TAG_COUNT = 2; // æ‰‹æ©Ÿæœ€å¤šé¡¯ç¤º 2 å€‹ Tags
---

<article class="bg-[var(--bg-card)] rounded-xl shadow-md flex items-center p-4 hover:shadow-lg transition-all duration-300 group">
  
  <!-- 1. å·¦å´åœ–ç‰‡ (å›ºå®šå¤§å°) -->
  <div class="w-24 h-24 flex-shrink-0 overflow-hidden border border-[var(--border-color)] mr-4 rounded-lg">
    <a href={`/blog/${post.slug}`} class="block w-full h-full">
      <img 
        src={post.data.previewImage} 
        alt={post.data.title} 
        class="w-full h-full object-cover transition-transform duration-500 group-hover:scale-105" 
      />
    </a>
  </div>
  
  <!-- 2. å³å´å…§å®¹ -->
  <div class="flex-1 flex flex-col min-w-0">
    
    <!-- åˆ†é¡ž (Category) -->
    <div class="mb-2 flex flex-wrap gap-1 justify-end">
      {post.data.category.map(cat => (
        <a 
          href={`/category/${cat}`} 
          class="text-[10px] md:text-xs font-medium text-white bg-[var(--accent-color)] py-0.5 px-1.5 md:py-1 md:px-2 rounded-full hover:bg-[var(--accent-hover)] transition-colors"
        >
          {cat}
        </a>
      ))}
    </div>

    <!-- æ¨™é¡Œèˆ‡æ‘˜è¦ -->
    <div class="flex-grow">
      <h3 class="text-sm md:text-base font-bold text-[var(--text-primary)] mb-1 line-clamp-1">
        <a href={`/blog/${post.slug}`} class="hover:text-[var(--accent-color)] transition-colors">
          {post.data.title}
        </a>
      </h3>
      <p class="text-sm text-[var(--text-secondary)] line-clamp-1 mb-2">{post.data.description}</p>
    </div>

    <!-- 
       â˜… åº•éƒ¨è³‡è¨Šå€ (è¤‡é›œéŸ¿æ‡‰å¼çµæ§‹)
       é€™è£¡æ˜¯ Flexbox å¤–å±¤ï¼ŒæŽ§åˆ¶åž‚ç›´/æ°´å¹³ä½ˆå±€
    -->
    <div class="flex flex-col md:flex-row justify-between text-xs text-gray-500 gap-y-1 md:gap-3">
      
      <!-- 
         å€å¡Š A: æ—¥æœŸå’Œ Tags
         flex-col: æ‰‹æ©Ÿåž‚ç›´å †ç–Š (å¯¦ç¾æ—¥æœŸåœ¨ä¸Šï¼ŒTagsåœ¨ä¸‹)
         md:flex-row: é›»è…¦æ°´å¹³ä¸¦æŽ’ (å¯¦ç¾ Tagsåœ¨å·¦ï¼Œæ—¥æœŸåœ¨å³)
      -->
      <div class="flex flex-col md:flex-row md:items-center gap-1 md:gap-3 flex-1 min-w-0">
        
        <!-- æ—¥æœŸ (æ‰‹æ©Ÿåœ¨ä¸Šï¼Œé›»è…¦åœ¨å·¦) -->
        <span class="flex-shrink-0 whitespace-nowrap text-gray-400">
          {formatDate(post.data.publishDate)}
        </span>
        
        <!-- 
           Tags å®¹å™¨ (é—œéµçš„æˆªæ–·é‚è¼¯)
           w-full md:w-auto: ç¢ºä¿æ‰‹æ©Ÿç«¯ä½”æ»¿ä¸‹æ–¹ç©ºé–“
           
           ðŸš¨ é—œéµä¿®æ­£ï¼š
           1. md:flex-nowrap: é›»è…¦å¼·åˆ¶ä¸æ›è¡Œ
           2. overflow-hidden: è®“è¶…å‡ºéƒ¨åˆ†éš±è—
           3. pr-2: é ç•™ç·©è¡ç©ºé–“ (è§£æ±ºè¢«åˆ‡åŠå’Œè²¼é‚Šçš„å•é¡Œ)
        -->
        <div class="flex flex-wrap md:flex-nowrap gap-x-2 gap-y-1 h-5 overflow-hidden content-center pr-2">
          
          {post.data.tags?.map((tag, index) => (
            <a 
              href={`/archive?q=${encodeURIComponent(tag)}`}
              class={`
                text-xs text-gray-500 hover:text-[var(--accent-color)] hover:underline transition-colors 
                whitespace-nowrap flex-shrink-0
                ${index >= 2 ? 'hidden md:inline-block' : ''} 
              `}
            >
              #{tag}
            </a>
          ))}
        </div>
      </div>

      <!-- å€å¡Š B: é–±è®€æ›´å¤š (é å³) -->
      <a href={`/blog/${post.slug}`} class="text-[var(--accent-color)] hover:underline ml-auto md:ml-0 flex-shrink-0">
        é–±è®€ &rarr;
      </a>

    </div>
  </div>
</article>
